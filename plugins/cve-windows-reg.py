import re

def get_software_list() -> list:
    import winreg

    def format(parts: tuple) -> tuple:
        product_part = parts[0]
        product_part = re.sub(r' |--+', '-', re.sub(r'[^0-9a-z\-_~+\. ]', '', product_part.lower()).strip())

        return (product_part, parts[1])
    
    def query_reg(hive, flag) -> list:
        
        registry_key = winreg.OpenKey(winreg.ConnectRegistry(None, hive),
                                      r"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall",
                                      0, winreg.KEY_READ | flag)

        subkey_count = winreg.QueryInfoKey(registry_key)[0]

        software_list = []

        for i in range(subkey_count):
            try:
                subkey = winreg.OpenKey(registry_key, winreg.EnumKey(registry_key, i))

                software_name = winreg.QueryValueEx(subkey, 'DisplayName')[0]
                software_version = ''
                try:
                    software_version = winreg.QueryValueEx(subkey, 'DisplayVersion')[0]
                except EnvironmentError:
                    software_version = '*'
                

                software_list.append(format((software_name, software_version)))

            except EnvironmentError:
                continue

        return software_list
    
    software_list = query_reg(winreg.HKEY_LOCAL_MACHINE, winreg.KEY_WOW64_32KEY) + query_reg(winreg.HKEY_LOCAL_MACHINE, winreg.KEY_WOW64_64KEY) + query_reg(winreg.HKEY_CURRENT_USER, 0)

    return software_list

def get_supported_os() -> set:
    return {'Windows:*'}