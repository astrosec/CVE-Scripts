import subprocess
import re

def get_software_list() -> list:
    results = []
    cmd = 'yum list installed | tail -n +2'
    process_result = subprocess.run(cmd, shell=True, check=True, text=True, capture_output=True)
    package_pattern = re.compile(r'^[a-zA-Z\-0-9+_~]+')
    version_pattern = re.compile(r' \d+[^\s]*')
    parsed_packages = parse_package_version(process_result.stdout.split('\n'), package_pattern, version_pattern)
    parsed_packages = [(entry[0].lower(), entry[1]) for entry in parsed_packages]
    results = parsed_packages

    cmd = 'flatpak list'
    process_result = subprocess.run(cmd, shell=True, check=True, text=True, capture_output=True)
    if 'not found' not in process_result.stdout:
        package_pattern = re.compile(r'[a-zA-Z\-0-9+_~]+\.[a-zA-Z\-\.0-9+_~]+')
        version_pattern = re.compile(r'\t\d+[^\s]*')
        parsed_packages = parse_package_version(process_result.stdout.split('\n')[1:-1], package_pattern, version_pattern)
        parsed_packages = [(entry[0].split('.')[-1], entry[1]) for entry in parsed_packages]
        results.extend(parsed_packages)
    
    return results

def get_supported_os() -> set:
    return {'Linux:RedHat', 'Linux:Fedora Linux'}

def parse_package_version(process_results: list, package_pattern: re, version_pattern: re) -> list:
    parsed_results = []
    for line in process_results:
        if len(line) <= 1 or line == '\n':
            continue

        package_part = package_pattern.search(line)
        version_part = version_pattern.search(line)
        parsed_results.append((package_part.group().strip(), version_part.group().strip()))
    return parsed_results