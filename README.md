# CVE-Scripts

A Linux based script that runs a custom implimentation of [CVE-Search](https://github.com/cve-search/cve-search) that allows for the production of detailed reports of software packaged on a system.

## Setup

---

This software requires [Docker](https://www.docker.com/) on a Linux distrobution to run.

With Docker installed, open a terminal in the project directory then build the project with:

`sudo docker build -t cves .`

Run the Docker container:

`sudo docker run --rm -it -p5000:5000 --security-opt seccomp=unconfined cves`

Enter the docker container if you are not already inside with:

`sudo docker exec -it <container id> /bin/bash`

To get the container id, run
`sudo docker ps`
and find the ID of the container named `cves`.

Download and process the CVE and CPE databases and start the webserver:

`cvedb -i -w`

This process could take over an hour depending on internet speed. Some of the progress bars don't function properly, but they are working. `-i` flag is what downloads and processes all the database data. This is only required to be done periodically to keep the database updated. To begin the webserver without reinitializing the entire database, just omit the `-i`.

Once it completes, the database websever will automatically start. To connect to the webserver, open a web browser and enter:

`http://localhost:5000`

## Performing a Query using versionScript.py

---

`cve_search.py` is a [Python](https://www.python.org/) script than can be used to effectively generate reports for software/version pair vulnerabilities.

The script can be run with the following flags in the format `python3 cve_search.py <flag> <arguments> ...`:

|  Flag  | Arguments | Description                     |
| ------ | --------- | ------------------------------- |
| `-ap` or `--allPackages` | N/A       | Queries the database for all packages installed on the system the script is running on. |
| `-p` or `--package` | `<package>` `<version>` | Queries the database for the specified package/version pair. |
| `-f` or `--file` | `relative/path/to/file` | Queries the database for a series of package/version pairs supplied in the specified file. The format for said file must be `<package> <version>` with each separated by a new line. |
| `-r` or `--remote` | `http://databaseurl:port/<package>/<version>/ ...` | Sets the database url for queries to the specified url. This flag must be paired with another one to perform a query. |
| `-v` or `--verbose` | N/A | Will expand the reporting done by breaking down the package version into parts to query for. This will potentially list more vulnerabilities due to a much broader search, but the results might not be applicable to the actual installed software. |

All of these flags can be used together if desired. The results of the query will be compiled into `report.csv` inside the project directory.
