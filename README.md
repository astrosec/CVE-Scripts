# CVE-Scripts for buildroot
<pre>
Scripts to gather CVE related data


#build the docker container
sudo docker build -t cve-search .
#start the docker container
sudo docker run -d -p 5000:5000 -t cve-search
#find out where it is
sudo docker ps
#locate container ID
#CONTAINER ID        IMAGE               COMMAND             CREATED              STATUS              PORTS                               NAMES
#3c6e0baa7603        cve-search          "cvedb -u -w"       About a minute ago   Up About a minute   0.0.0.0:5000->5000/tcp, 27017/tcp   quirky_brown
#start a shell in that container
sudo docker exec -t -i 3c6e0baa7603 /bin/bash

#drop and update the database
#This takes quite a while 
./sbin/db_updater.py -v -f

#if that fails restart the docker container and try again
sudo docker restart 3c6e0baa7603


#index all the CVEs from current MongoDB collection:
./sbin/db_fulltext.py -l 0
Processing[###  ] 1126/136542

Dropping metadata
==========================
Tue 14 January 2020 05:33
==========================
Dropping collection: cpe
cpe dropped
Starting cpe
Database population started
cpe has 293463 elements (293463 update)
Dropping collection: cve
cve dropped
Starting cve
Database population started
Importing CVEs for year 2002
Importing CVEs for year 2003
Importing CVEs for year 2004
Importing CVEs for year 2005
Importing CVEs for year 2006
Importing CVEs for year 2007
Importing CVEs for year 2008
Importing CVEs for year 2009
Importing CVEs for year 2010
Importing CVEs for year 2011
Importing CVEs for year 2012
Importing CVEs for year 2013
Importing CVEs for year 2014
Importing CVEs for year 2015
Importing CVEs for year 2016
Importing CVEs for year 2017
Importing CVEs for year 2018
Importing CVEs for year 2019
Importing CVEs for year 2020
cve has 136542 elements (136542 update)
Dropping collection: cwe
cwe dropped
Starting cwe
Preparing [##################################################] 1005/1005
cwe has 1005 elements (1005 update)
Dropping collection: capec
capec dropped
Starting capec

capec has 0 elements (0 update)
Dropping collection: via4
via4 dropped
Starting via4
via4 has 117666 elements (117666 update)
Starting ensureindex
[+]Success to create index id on cpe
[+]Success to create index id on cpeother
[+]Success to create index id on cves
[+]Success to create index vulnerable_configuration on cves
[+]Success to create index vulnerable_product on cves
[+]Success to create index Modified on cves
[+]Success to create index [('summary', 'text')] on cves
[+]Success to create index id on via4
[+]Success to create index id on mgmt_whitelist
[+]Success to create index id on mgmt_blacklist
[+]Success to create index related_weakness on capec
</pre>

