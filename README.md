# CVE-Scripts

A Linux based script that runs a custom implimentation of [CVE-Search](https://github.com/cve-search/cve-search) that allows for the production of detailed reports of software packaged on a system.

## Usage

---

### Setup

This software requires [Docker](https://www.docker.com/) on a Linux distrobution to run.

With Docker installed, open a terminal in the project directory then build the project with:

> `sudo docker build -t cves .`

Run the Docker container:

> `sudo docker run --rm -it -p5000:5000 --security-opt seccomp=unconfined cves`

Enter the docker container if you are not already inside with:

> `sudo docker exec -it <container id> /bin/bash`

To get the container id, run
`sudo docker ps`
and find the ID of the container named `cves`. By default, the `docker run` command above will put you inside the container already.

Download and process the CVE and CPE databases and start the webserver:

> `cvedb -i -w`

This process could take over an hour depending on internet speed. Some of the progress bars don't function properly, but they are working. `-i` flag is what downloads and processes all the database data. This is only required to be done periodically to keep the database updated. To begin the webserver without reinitializing the entire database, just omit the `-i`.

Once it completes, the database websever will automatically start. To connect to the webserver, open a web browser and enter:

> `http://localhost:5000`

### Performing a Query using versionScript.py

To perform a query on your system, type in the program directory:

> `python versionScript.py -ap`

This will aquire a list of all installed software on your machine and and query them for known vulnerabilities in the database. The output `report.csv` will contain all found vulnerable software as well as a summary on the vulernabilities.

To perform a query for a specific package/version combination, type:

> `python versionScript.py -p <package> <version>`

This will query the provided package/version combination and output the `report.csv` as well as print to the standard output.

If you wish to compile a custom list of software packages to query, provide them in a file in the following format: `<package> <version>` separated by a new line for each package. Then run the script like so:

> `python versionScript.py -f relative/path/to/file`

This will read and query all the software packages from the file and output the report into `report.csv`.

It is also possible to query a remote database if you are running the script on a Virtual Machine for example and have the cve-search database on the host using the `-r` flag.

> `python versionScript.py -r http://databaseurl:port/<package>/<version>/ ...`

The `<package>` and `<version>` parts in this case are not placeholders, they specify where in the url the package and version parts are inserted. By itself this doesn't do anything. Use in combination with another flag above.

All of these flags can be used together. For example:

> `python versionScript.py -ap -p whoopsie 0.2.67 -f software.txt`

This will combine the report of all of these into `report.csv`.
